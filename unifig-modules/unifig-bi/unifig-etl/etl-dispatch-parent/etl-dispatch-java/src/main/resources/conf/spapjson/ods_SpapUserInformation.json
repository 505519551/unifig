{
     "selectUserInfoLimit": "SELECT DISTINCT
                                   u.`user_id`,
								   u.`spap_id`,
								   u.`cube`,
								   u.`nickname`,
								   u.`face_src`,
								   u.`large_face_src`,
								   u.`small_face_src`,
								   u.`email`,
								   u.`mobile`,
								   u.`register_ip`,
								   u.`sex`,
								   u.`qr_code`,
								   u.`update_time`,
								   u.`create_time`,
								   u.`nn_time`,
								   u.`profile_birth_time` AS age,
								   u.`email_activation_time`,
								   u.`guest`,
								   u.`register_state`,
								   u.`industry_code`,
								   u.`industry_name`,
								   u.`industry_name` AS industry_id,
								   u.`province`,
								   u.`city`,
								   u.`county`,
								   u.`register_type`,
                                   r.`app_device_type` AS app_plat_id,
                                   r.`app_version` AS app_version_id,
                                   r.`device_vendor` AS manufacturer_id,
                                   r.`device_model` AS manufacturer_model_id,
                                   r.`os_name` AS os_id,
                                   r.`os_version` AS os_version_id,
                                   IFNULL( ( SELECT DISTINCT network FROM bi_interface_spap.spap_login_log_yyyymmdd l WHERE l.user_id = u.user_id LIMIT 1 ),- 9 ) AS network_id,
                                   IFNULL( ( SELECT DISTINCT channel FROM bi_interface_spap.spap_login_log_yyyymmdd l WHERE l.user_id = u.user_id LIMIT 1 ),- 9 ) AS channel,
                                   u.`year`,
                                   u.`month`,
                                   u.`day`,
                                   u.`hour`,
                                   u.`store_id` 
                                FROM
                                    bi_interface_spap.user_info_yyyymmdd u
                                    LEFT JOIN (
                                SELECT DISTINCT
                                    x.user_id,
                                    x.timestamp,
                                    x.app_version,
                                    x.channel,
                                    x.type,
                                    x.device_vendor,
                                    x.os_name,
                                    x.os_version,
                                    x.device_model,
                                    x.app_device_type,
                                    x.`year`,
                                    x.`month`,
                                    x.`day`,
                                    x.`hour` 
                                FROM
                                    bi_interface_spap.spap_register_log x 
                                 
                                    ) r ON u.user_id = r.user_id
								limit ${offset},${rows}",
								
	 "create_ods_userInfo": "CREATE TABLE IF NOT EXISTS bi_ods_spap.ods_user_info_dm_yyyymm (
								      `user_id` bigint(20) unsigned NOT NULL DEFAULT '0' COMMENT '租户id，主键（自动增长）',
								      `new_user` int(1) NOT NULL COMMENT '0-新用户 1-老用户',
								      `spap_id` bigint(20) NOT NULL COMMENT '司派号',
								      `cube` varchar(64) NOT NULL COMMENT 'cube号',
								      `nickname` VARCHAR (64) NOT NULL COMMENT '昵称',
                                      `face_src` VARCHAR (255) DEFAULT NULL COMMENT '租户图像地址',
                                      `large_face_src` VARCHAR (255) DEFAULT NULL,
                                      `small_face_src` VARCHAR (255) DEFAULT NULL,
                                      `email` varchar(64) DEFAULT NULL COMMENT '邮箱',
                                      `mobile` varchar(32) DEFAULT NULL COMMENT '联系电话',
                                      `register_ip` varchar(32) DEFAULT '127.0.0.1' COMMENT '租户注册IP地址',
                                      `sex` int(1) NOT NULL DEFAULT '0' COMMENT '0-未设置 1-男 2-女',
                                      `qr_code` VARCHAR (256) DEFAULT NULL COMMENT '二维码路径',
                                      `update_time` BIGINT (21) DEFAULT '0' COMMENT '最后更新时间戳',
                                      `create_time` bigint(20) NOT NULL DEFAULT '0' COMMENT '创建时间',
                                      `nn_time` bigint(20) DEFAULT NULL COMMENT '昵称修改时间',
                                      `profile_birth_time` bigint(20) DEFAULT NULL COMMENT '生日',
                                      `email_activation_time` bigint(20) DEFAULT '0' COMMENT '邮箱激活时间',
                                      `guest` int(1) NOT NULL DEFAULT '0' COMMENT '0-注册用户 1-游客',
                                      `register_state` int(1) DEFAULT NULL COMMENT '是否设置密码标记 0-正常注册 1-为手机登录生成账号未设置密码',
  									  `industry_code` int(11) DEFAULT NULL COMMENT '行业代码',
 									  `industry_name` varchar(64) DEFAULT NULL COMMENT '行业名称',
  									  `province` varchar(64) DEFAULT NULL COMMENT '省',
									  `city` varchar(64) DEFAULT NULL COMMENT '市',
									  `county` varchar(64) DEFAULT NULL COMMENT '县',
									  
									  `register_type` int(1) NOT NULL DEFAULT '0' COMMENT '注册类型 0-个人注册 1-企业注册',
									  `age` int(10) DEFAULT NULL COMMENT 'profile_birth_time 解析生日获取年龄',
									  `industry_id` int(10) DEFAULT NULL COMMENT 'industry_name 行业维表dim_industry字典匹配自增获取',
									  `app_plat_id` int(10)  DEFAULT NULL COMMENT 'app_device_type  平台应用类型维表dim_app_plat字典匹配自增获取',
									  `app_id` int(2)  DEFAULT NULL COMMENT 'app_id',
									  `app_version_id` int(10) DEFAULT '1.5' COMMENT 'app_version 平台应用 版本维表conf_app_version字典匹配自增获取',
									  `os_id` int(10) DEFAULT NULL COMMENT 'os_name 操作系统维表dim_os字典匹配自增获取',
									  `os_version_id` int(10)  DEFAULT NULL COMMENT 'os_version 操作系统版本维表dim_os_version字典匹配自增获取',
									  `manufacturer_id` int(10) DEFAULT NULL COMMENT 'device_vendor 设备生产厂家维表dim_manufacturer字典匹配自增获取',
									  `manufacturer_model_id` int(10) DEFAULT NULL COMMENT 'device_model 设备型号维表dim_manufacturer_model字典匹配自增获取',
									  `isp_id` int(10) DEFAULT NULL COMMENT 'oper_ip IP地址庫 固网运营商字典维表dim_isp字典匹配自增获取',
                                      `country_id` int(10) DEFAULT NULL COMMENT 'oper_ip IP地址庫 固网运营商字典维表dim_isp字典匹配自增获取',
                                      `region_id` int(10) DEFAULT NULL COMMENT 'oper_ip IP地址庫 国家字典表维表dim_country字典匹配自增获取',
                                      `city_id` int(10) DEFAULT NULL COMMENT 'oper_ip IP地址庫 地市维表dim_city字典匹配自增获取',
									  `channel` int(4) DEFAULT '1000' COMMENT '渠道（0-官方）',
									  `network` int(4) DEFAULT NULL COMMENT '联网类型',
									  `year` int(9) NOT NULL DEFAULT '1900' COMMENT '年',
									  `month` int(9) NOT NULL DEFAULT '0' COMMENT '月',
									  `day` int(9) NOT NULL DEFAULT '0' COMMENT '日',
									  `hour` int(9) NOT NULL DEFAULT '0' COMMENT '小时',
									  `register_date` int(9) NOT NULL DEFAULT '0' COMMENT '注册时间',
									  `insert_date` int(9) NOT NULL DEFAULT '0' COMMENT '插入ods时间',
									INDEX `idx_ods_user_info_date` (`year`, `month`, `day`),
									INDEX `idx_ods_user_info_range` (`insert_date`)
								) ENGINE=MyISAM DEFAULT CHARSET=utf8",
     "delete_yes_date":"delete from bi_ods_spap.ods_user_info_dm_yyyymm where 1=1 AND insert_date = ${statisDate} ",
	 "delete_table":"drop TABLE IF EXISTS bi_ods_spap.ods_user_info_dm_yyyymm ;",
     "delete_date":"delete from bi_ods_spap.ods_user_info_dm_yyyymm where 1=1 AND insert_date < ${statisDate} "
								
}