{

    "templateDmTableSql": "CREATE TABLE IF NOT EXISTS bi_dw.dw_engine_singlecall_log_dm_yyyymm (
                                `statis_date` int(10) DEFAULT NULL COMMENT '分区',
                                `master` int(10) DEFAULT NULL COMMENT '发送者',
                                `create_time` bigint(13) DEFAULT NULL COMMENT '创建时间',
                                `answered_time` bigint(13) DEFAULT NULL COMMENT '应答时间',
                                `profile_create_time` bigint(13) DEFAULT NULL COMMENT '通话开始时间',
                                `hangup_time` bigint(13) DEFAULT NULL COMMENT '挂断时间',
                                `out_audio_size` bigint(13) DEFAULT NULL COMMENT '语音上行流量',
                                `in_audio_size` bigint(13) DEFAULT NULL COMMENT '语音下行流量',
                                `out_video_size` bigint(13) DEFAULT NULL COMMENT '视屏上行流量',
                                `in_video_size` bigint(13) DEFAULT NULL COMMENT '视屏下行流量',
                                `call_type` int(2) DEFAULT NULL COMMENT '呼叫类型:1-语音，2-视频',
                                `duration` int(10) DEFAULT NULL COMMENT '时长,单位s',
                                `action` varchar(255) DEFAULT NULL COMMENT '流量产生动作',
                                `caller` int(10) DEFAULT NULL COMMENT '呼叫方',
                                `callee` int(10) DEFAULT NULL COMMENT '被叫方',
                                `network_type_id` int(2) DEFAULT NULL COMMENT '流量类型(3G,4G,Wifi)',
                                `isp_id` int(4) DEFAULT NULL COMMENT 'oper_ip IP地址庫 固网运营商字典维表dim_isp字典匹配自增获取',
                                `country_id` int(4) DEFAULT NULL COMMENT 'oper_ip IP地址庫 国家字典表维表dim_country字典匹配自增获取',
                                `region_id` int(4) DEFAULT NULL COMMENT 'oper_ip IP地址庫 省/地区维表dim_region字典匹配自增获取',
                                `city_id` int(4) DEFAULT NULL COMMENT 'oper_ip IP地址庫 地市维表dim_city字典匹配自增获取',
                                `app_plat_id` int(2) DEFAULT NULL COMMENT '平台应用类型',
                                `app_id` int(2) DEFAULT NULL COMMENT 'app_id',
                                `app_version_id` varchar(13) DEFAULT NULL COMMENT '坐标版本号',
                                `year` int(4) DEFAULT NULL COMMENT '年',
                                `month` int(2) DEFAULT NULL COMMENT '月',
                                `day` int(2) DEFAULT NULL COMMENT '日',
                                `hour` int(2) DEFAULT NULL COMMENT '时',
                                `call_count` int(4) DEFAULT '0' COMMENT '呼叫次数',
                              KEY `idx_dw_engine_singlecall_log_dm_yyyymm_date` (`year`,`month`,`day`),
                              KEY `idx_dw_engine_singlecall_log_dm_yyyymm_range` (`statis_date`)
                            ) ENGINE=MyISAM DEFAULT CHARSET=utf8;",                          
                                
     "insertDmSelectSql": "INSERT INTO bi_dw.dw_engine_singlecall_log_dm_yyyymm (
                                `statis_date`,
                                `master`,
                                `create_time`,
                                `answered_time`,
                                `profile_create_time`,
                                `hangup_time`,
                                `out_audio_size`,
                                `in_audio_size`,
                                `out_video_size`,
                                `in_video_size`,
                                `call_type`,
                                `action`,
                                `duration`,
                                `caller`,
                                `callee`,
                                `network_type_id`,
                                `isp_id`,
                                `country_id`,
                                `region_id`,
                                `city_id`,
                                `app_plat_id`,
                                `app_id`,
                                `app_version_id`,
                                `year`,
                                `month`,
                                `day`,
                                `hour`,
                                `call_count`
                            ) 
                            SELECT
                                `store_id` AS statis_date,
                                `master`,
                                `create_time`,
                                `answered_time`,
                                `profile_create_time`,
                                `hangup_time`,
                                sum(`out_audio_bytes`) AS out_audio_size,
                                sum(`in_audio_bytes`) AS in_audio_size,
                                sum(`out_video_bytes`) AS out_video_size,
                                sum(`in_video_bytes`) AS in_video_size,
                                `call_type`,
                                `action`,
                                sum(`duration`) AS duration_size,
                                `caller` ,
                                `callee` ,
                                `network_type_id` ,
                                `isp_id` ,
                                `country_id` ,
                                `region_id`,
                                `city_id`,
                                `app_plat_id` ,
                                `app_id` ,
                                `app_version_id`,
                                `year` ,
                                `month` ,
                                `day` ,
                                `hour` ,    
                                count(1) AS call_count
                            FROM
                                bi_dwd.dwd_engine_singlecall_log_dm_yyyymm
                            WHERE
                                1 = 1
                            AND `store_id` = ${store_id}
                            GROUP BY
                                `store_id`,
                                `master`,
                                `create_time`,
                                `answered_time`,
                                `profile_create_time`,
                                `hangup_time`,
                                `call_type`,
                                `action`,
                                `caller`,
                                `callee`,
                                `network_type_id`,
                                `isp_id`,
                                `country_id`,
                                `region_id`,
                                `city_id`,
                                `app_plat_id`,
                                `app_id`,
                                `app_version_id`,
                                `year`,
                                `month`,
                                `day`,
                                `hour`",
      "delete_yes_date":"delete from bi_dw.dw_engine_singlecall_log_dm_yyyymm where 1=1 AND statis_date = ${statisDate} ",
      "delete_table":"drop TABLE IF EXISTS bi_dw.dw_engine_singlecall_log_dm_yyyymm ;",
      "delete_date":"delete from bi_dw.dw_engine_singlecall_log_dm_yyyymm where 1=1 AND statis_date < ${statisDate} "
}